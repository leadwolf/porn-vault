(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{375:function(t,a,s){"use strict";s.r(a);var e=s(45),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"plugin-development"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#plugin-development"}},[t._v("#")]),t._v(" Plugin development")]),t._v(" "),s("p",[t._v("Plugins are Javascript files that expose a Javascript function.\nThey receive a plugin context to do some task.\nPer event (e.g. on creation of some item), multiple plugins can be executed serially.\nCheck the plugin repository (https://github.com/porn-vault/porn-vault-plugins) for plugins and inspiration.")]),t._v(" "),s("h2",{attrs:{id:"example-plugin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example-plugin"}},[t._v("#")]),t._v(" Example plugin")]),t._v(" "),s("p",[t._v("As an example, here's a plugin that will attach the label 'Female' to every item (scene or actor) that is created.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("ctx")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Attach label 'Female' to every actor (actress) we create")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    labels"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Female"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"plugin-boilerplate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#plugin-boilerplate"}},[t._v("#")]),t._v(" Plugin boilerplate")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("ctx")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("If you do asynchronous tasks (like scraping a website), you'll need to export an async function instead.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Returns a promise, which will be awaited by the plugin handler")]),t._v("\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("ctx")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"plugin-context"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#plugin-context"}},[t._v("#")]),t._v(" Plugin context")]),t._v(" "),s("p",[t._v("The plugin context contains loads of useful modules & functions, and event-specific info (see 'Events'), to ease plugin development:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("$axios")]),t._v(", to run http requests (https://github.com/axios/axios)")]),t._v(" "),s("li",[s("code",[t._v("$moment")]),t._v(", to parse time (https://github.com/moment/moment)")]),t._v(" "),s("li",[s("code",[t._v("$log(...str)")]),t._v(", to pretty print messages; this should be preferred over using the default console log")]),t._v(" "),s("li",[s("code",[t._v("$throw(str)")]),t._v(", to throw errors; this should be preferred over using the default Javascript throw")]),t._v(" "),s("li",[s("code",[t._v("$loader")]),t._v(", to show a loading spinner (https://github.com/sindresorhus/ora)")]),t._v(" "),s("li",[s("code",[t._v("$fs")]),t._v(": Node FS API")]),t._v(" "),s("li",[s("code",[t._v("$path")]),t._v(": Node path API")]),t._v(" "),s("li",[s("code",[t._v("$os")]),t._v(": Node OS API")]),t._v(" "),s("li",[s("code",[t._v("$readline")]),t._v(": Node line reader API")]),t._v(" "),s("li",[s("code",[t._v("$inquirer")]),t._v(": Inquirer (https://github.com/SBoudrias/Inquirer.js)")]),t._v(" "),s("li",[s("code",[t._v("$ffmpeg")]),t._v(": fluent ffmpeg (https://github.com/fluent-ffmpeg/node-fluent-ffmpeg)")]),t._v(" "),s("li",[s("code",[t._v("$jimp")]),t._v(": Jimp (https://github.com/oliver-moran/jimp)")]),t._v(" "),s("li",[s("code",[t._v("$library")]),t._v(": Libary path")]),t._v(" "),s("li",[s("code",[t._v("$cwd")]),t._v(": Current working directory")]),t._v(" "),s("li",[s("code",[t._v("$pluginPath")]),t._v(": Path of currently running plugin")]),t._v(" "),s("li",[s("code",[t._v("$yaml")]),t._v(": YAML (https://github.com/eemeli/yaml)")]),t._v(" "),s("li",[s("code",[t._v("$require")]),t._v(": Load a JS file as dependency, like require, but works with relative paths")]),t._v(" "),s("li",[s("code",[t._v("event")]),t._v(": Event name")]),t._v(" "),s("li",[s("code",[t._v("args")]),t._v(": Plugin arguments (see 'Arguments')")]),t._v(" "),s("li",[s("code",[t._v("data")]),t._v(": Result from previously ran plugins in chain")])]),t._v(" "),s("h2",{attrs:{id:"events"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#events"}},[t._v("#")]),t._v(" Events")]),t._v(" "),s("p",[s("strong",[t._v("actorCreated/actorCustom")])]),t._v(" "),s("p",[t._v("Input: "),s("code",[t._v("{ actor, actorName, $createImage, $createLocalImage }")])]),t._v(" "),s("p",[t._v("Possible output:")]),t._v(" "),s("div",{staticClass:"language-typescript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  description"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  bornOn"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("number")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  thumbnail"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  aliases"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  labels"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("strong",[t._v("sceneCreated/sceneCustom")])]),t._v(" "),s("p",[t._v("Input: "),s("code",[t._v("{ scene, sceneName, scenePath, $createImage, $createLocalImage }")])]),t._v(" "),s("p",[t._v("Possible output:")]),t._v(" "),s("div",{staticClass:"language-typescript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  description"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  releaseDate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("number")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  thumbnail"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  actors"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  labels"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  studio"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("strong",[t._v("movieCreated")])]),t._v(" "),s("p",[t._v("Input: "),s("code",[t._v("{ movie, movieName, $createImage, $createLocalImage }")])]),t._v(" "),s("p",[t._v("Possible output:")]),t._v(" "),s("div",{staticClass:"language-typescript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  description"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  releaseDate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("number")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  frontCover"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  backCover"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  labels"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("hr"),t._v(" "),s("p",[s("code",[t._v("async $createImage(url: string, name: string, thumbnail?: boolean)")]),t._v(": Downloads and inserts an image into the database. thumbnail should be set to true if the image is supposed to be a thumbnail.\nReturns ID of the image, which can be used to set the thumbnail.\nNote this function is async, so await has to be used.")]),t._v(" "),s("p",[s("code",[t._v("async $createLocalImage")]),t._v(", same as "),s("code",[t._v("$createImage")]),t._v(", but doesn't download an image, but searches on the local file system instead.")]),t._v(" "),s("h2",{attrs:{id:"additional-arguments"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#additional-arguments"}},[t._v("#")]),t._v(" Additional arguments")]),t._v(" "),s("p",[t._v("Additional arguments can be passed to plugins.\nThey will be accessible as "),s("code",[t._v("ctx.args")]),t._v("."),s("br"),t._v(" "),s("a",{attrs:{href:"plugins-intro"}},[t._v("See the plugin intro to see how they are defined")])]),t._v(" "),s("h2",{attrs:{id:"advanced-stuff"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#advanced-stuff"}},[t._v("#")]),t._v(" Advanced stuff")]),t._v(" "),s("p",[s("a",{attrs:{href:"pipe-plugins"}},[t._v("Pipe plugin results")])])])}),[],!1,null,null,null);a.default=n.exports}}]);